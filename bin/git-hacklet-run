#!/bin/bash

source ${0%/*}/scripts.d/core.sh

if [ ! -n "$1" ]; then
    echo "Must pass the name to 'git hacklet run'";
    exit 1;
fi

MPWD=`pwd`;
echo "$GIT_HACKLET_BASEDIR_NAME" > "${MPWD}/$GIT_HACKLET_BASEDIR_NAME/${1}/info/exclude";
for i in `ls $GIT_HACKLET_BASEDIR_NAME/ | grep -v "${1}"`;
do
    GIT_WORK_TREE=$MPWD GIT_DIR="${MPWD}/$GIT_HACKLET_BASEDIR_NAME/${i}" git ls-files >> "${MPWD}/$GIT_HACKLET_BASEDIR_NAME/${1}/info/exclude";
done

GIT_WORK_TREE=$MPWD GIT_DIR="${MPWD}/$GIT_HACKLET_BASEDIR_NAME/${1}" $2;
